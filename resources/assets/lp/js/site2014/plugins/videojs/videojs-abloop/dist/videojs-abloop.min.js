!function(e,t){"function"==typeof define&&define.amd?define([],t.bind(this,e,e.videojs)):"undefined"!=typeof module&&module.exports?module.exports=t(e,e.videojs):t(e,e.videojs)}(window,function(e,t){"use strict";var n="1.0.1",o=function(o){o=o||{};var r=this,a=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},i=function(e){return e&&"[object Function]"==={}.toString.call(e)},u=function(e){return!!e},f=function(e,n){return n=n||1,t.formatTime(e)+"."+Math.floor(e%1*Math.pow(10,n))},c=function(e,t){var n=Math.pow(10,t);return Math.floor(e*n)/n},l=function(e){if(void 0!==e){if(a(e))return e;if(/^([+\-])?([\d\.]+)$/i.test(e))return parseFloat(e);var t=/^([+\-])?((([\d]+)(h|:(?=.*:)))?(([\d]+)(m|:|$))?)?(([\d\.]+)s?)?$/i.exec(e);if(!t)return null;var n={match:t[0],sign:t[1],hours:t[4]||0,mins:t[7]||0,secs:t[10]||0},o="-"==n.sign?-1:1,r=60*parseFloat(n.hours)*60+60*parseFloat(n.mins)+parseFloat(n.secs);return a(r)?o*r:null}},s={},p={start:{default:0,validate:function(e){return!1===e?e:a(e)&&e>=0?e:0}},end:{default:!1,validate:function(e){if(!1===e)return e;if(a(e)){var t=r.duration();if(void 0===t||0===t){if(e>=0)return e}else{if(e>=0&&e<=t)return e;if(e>t)return t}}return!1}},enabled:{default:!1,validate:u},loopIfBeforeStart:{default:!0,validate:u},loopIfAfterEnd:{default:!0,validate:u},pauseBeforeLooping:{default:!1,validate:u},pauseAfterLooping:{default:!1,validate:u}},d={onLoopCallBack:{default:void 0,check:i},onOptionsChange:{default:void 0,check:i}},g=Object.keys(p),h=Object.keys(d),L=function(){return g.forEach(function(e){s[e]=p[e].validate(s[e])}),H},v=function(){return m(o,!0)},m=function(e,t){return g.forEach(function(n){(t||void 0!==e[n])&&(s[n]=e[n])}),L(),H},y=!1,b=function(e){return e?s.pauseBeforeLooping&&!1===y?(r.pause(),y=!0):(y=!1,r.currentTime(s.start),s.pauseAfterLooping&&r.pause(),d.onLoopCallBack.check(H.onLoopCallBack)&&H.onLoopCallBack(H,r)):(y=!1,r.currentTime(s.start)),H},U=function(e){return function(t){return!1===t?s[e]=!1:(void 0!==t&&(t=l(t)),null!==t&&(t=void 0===t?r.currentTime():t,s[e]=t)),H}},E=function(e){return function(t){return t=l(t),a(t)&&(s[e]+=t),H}},A=function(){return s.enabled=!0,H},B=function(e){return function(){return s[e]=!s[e],H}},O=function(e){(e=e||{}).decimalPlaces=Math.floor(e.decimalPlaces)||3;var t=!1!==s.start?parseFloat(s.start):0,n="#t="+c(t,e.decimalPlaces);if(!1!==s.end){var o=parseFloat(s.end);n+=","+c(o,e.decimalPlaces)}return n},k=function(e){e=e||{};var t=r.currentSrc();return t.src&&(t=t.src),t+O(e)},S=function(e){if("string"==typeof e&&(e=t.parseUrl(e)),e.hash){var n=/^(#?t=)?([^,]*)(,(.*))?$/,o=e.hash.replace(n,"$2"),r=e.hash.replace(n,"$4");o=l(o),r=l(r),a(o)&&(s.start=parseFloat(o)),a(r)&&(s.end=parseFloat(r))}return H},P=function(e){var t,n,o=e;return"string"==typeof e?o=[e]:void 0!==e&&Array.isArray(e)||(o=null!==e&&"object"==typeof e?Object.keys(e):Object.keys(p)),t=s,n={},o.forEach(function(e){void 0!==t[e]&&(n[e]=t[e])}),n},T=function(e,t){var n=!t;return t=t||{},g.forEach(function(e){t[e]=!!t[e]||n}),function(){var n=arguments,o=P(),a=e.apply(null,n),i={changed:t,oldOpts:o,newOpts:P()};return H.onOptionsChange&&H.onOptionsChange(i,H,r),q(t),a}},F=!1,x=function(){var e,t,n;if(L(),e=r.currentTime(),t=C(),(n=j())>t){if(F=!0,e<n-.5&&e>t&&(e-t<1||s.loopIfAfterEnd||s.loopIfBeforeStart))return!0}else{if(F=!1,e<n-.5&&s.loopIfBeforeStart)return!0;if(e>=t&&(e-t<1||s.loopIfAfterEnd))return!0}return!1},j=function(){return!1===s.start?0:s.start},C=function(){return!1===s.end?r.duration():s.end},K=!1,w=a(o.minLoopLength)&&o.minLoopLength>0?o.minLoopLength:200,$=function(e){!K&&s.enabled&&!r.paused()&&x()&&(K=!0,setTimeout(function(){K=!1},w),b(!0))},I={},M=[{name:"start",optionsUsed:["start"],leftclick:function(e,t){t.shiftKey?e.adjustStart(-.5):e.setStart()},rightclick:function(e,t){t.shiftKey?e.adjustStart(.5):e.goToStart()},defaultText:"Start",textFunction:function(e){return f(e.start)}},{name:"end",optionsUsed:["end"],leftclick:function(e,t){t.shiftKey?e.adjustEnd(-.5):t.ctrlKey?e.adjustEnd(-.05):e.setEnd()},rightclick:function(e,t){t.shiftKey?e.adjustEnd(.5):t.ctrlKey?e.adjustEnd(.05):e.goToEnd()},defaultText:"End",textFunction:function(e){return f(e.end)}},{name:"enabled",optionsUsed:["enabled","pauseAfterLooping","pauseBeforeLooping"],leftclick:function(t,n){e&&e.prompt?n.ctrlKey?t.applyUrl(N("Set new URL",t.getAbsoluteUrl())):n.altKey?t.applyUrl(N("Set new URL",t.getUrl())):n.shiftKey?t.applyUrlFragment(N("Set new URL fragment",t.getUrlFragment())):t.toggle():t.toggle()},rightclick:function(t,n){var o;e&&e.prompt&&(n.ctrlKey?o=t.getAbsoluteUrl():n.altKey?o=t.getUrl():n.shiftKey&&(o=t.getUrlFragment())),o?R(o):t.cyclePauseOnLooping()},defaultText:"Loop",textFunction:function(e){return e.enabled?e.pauseBeforeLooping&&e.pauseAfterLooping?"PAUSE LOOP PAUSE":e.pauseAfterLooping?"LOOP& PAUSE":e.pauseBeforeLooping?"PAUSE &LOOP":"LOOP ON":"Loop off"}}],R=function(t){e&&e.prompt&&e.prompt("Copy to clipboard: Ctrl+C, Enter",t)},N=function(t,n){return!(!e||!e.prompt)&&e.prompt(t,n)},D=function(e){e.forEach(function(e){var t,n,o,a,i,u;void 0===I[e.name]&&(I[e.name]=(t=e,i=function(e,t){return function(o){(void 0===t||o.which&&o.which==t)&&(e(n.abLoopPlugin,o),this.updateText())}},u=(n=r).controlBar.addChild("Button"),t.leftclick&&u.on("click",i(t.leftclick)),t.rightclick&&(u.el().onmousedown=i(t.rightclick,3).bind(u),u.on("contextmenu",function(e){return e.preventDefault&&e.preventDefault(),e.preventDefault&&e.stopPropagation(),!1})),u.updateText=(o=t.defaultText,a=t.textFunction,function(){var e=a(s)||o;this.el().textContent=e}),u.optionsUsed=t.optionsUsed,u.addClass("abLoopButton"),u.addClass(t.name),u.updateText(),u))})},q=function(e){var t=function(t,n){return t||e[n]};for(var n in I){var o=I[n];(!o.optionsUsed||o.optionsUsed.reduce(t,!1))&&o.updateText()}},H={validateOptions:T(L),resetToInitialOptions:T(v),setOptions:T(m),getOptions:P,goToStart:b,goToEnd:function(){return y=!1,r.currentTime(s.end),H},setStart:T(U("start"),{start:!0}),setEnd:T(U("end"),{end:!0}),adjustStart:T(E("start"),{start:!0}),adjustEnd:T(E("end"),{end:!0}),enable:T(A,{enabled:!0}),disable:T(function(){return s.enabled=!1,H},{enabled:!0}),toggle:T(B("enabled"),{enabled:!0}),togglePauseAfterLooping:T(B("pauseAfterLooping"),{pauseAfterLooping:!0}),togglePauseBeforeLooping:T(B("pauseBeforeLooping"),{pauseBeforeLooping:!0}),cyclePauseOnLooping:T(function(){var e=s.pauseAfterLooping,t=s.pauseBeforeLooping;return m(e||t?e&&!t?{pauseAfterLooping:!1,pauseBeforeLooping:!0}:!e&&t?{pauseAfterLooping:!0,pauseBeforeLooping:!0}:{pauseAfterLooping:!1,pauseBeforeLooping:!1}:{pauseAfterLooping:!0,pauseBeforeLooping:!1}),H},{pauseBeforeLooping:!0,pauseAfterLooping:!0}),player:r,version:n,getAbsoluteUrl:function(t){return function(t){if(!t.match(/^https?:\/\//)&&e&&e.document){var n=e.document.createElement("div");n.innerHTML='<a href="'+t+'">x</a>',t=n.firstChild.href}return t}(k(t))},getUrl:k,getUrlFragment:O,applyUrl:T(function(e){var t=e.replace(/^(.*?)(#.*)?$/,"$1"),n=e.replace(/^(.*?)(#.*)?$/,"$2"),o=r.currentSrc();return o!=t&&o!=e&&e!=n&&r.src(t),n&&S(n),H},{start:!0,end:!0}),applyUrlFragment:T(S,{start:!0,end:!0}),loopRequired:x,playLoop:T(function(){return L(),b(!1),A(),r.play(),H})};return function(){o=o||{};var e=function(e){return function(t){void 0===o[t]&&(o[t]=e[t].default)}};g.forEach(e(p)),h.forEach(e(d))}(),h.forEach(function(e){d[e].check(o[e])&&(H[e]=o[e])}),T(v)(),r.ready(function(){0!=o.createButtons&&D(M),r.on("ended",function(){F&&s.enabled&&!r.loop()&&r.play()})}),r.abLoopPlugin=H,r.on("timeupdate",$),H.loaded=!0,H};return o.loaded=!1,o.VERSION=n,(t.registerPlugin||t.plugin)("abLoopPlugin",o)});